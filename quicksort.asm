STSG SEGMENT STACK
	DW 127 DUP(?)
STSG ENDS
DATA SEGMENT
     NUMS DB 9 DUP(0)
DATA ENDS


CODE SEGMENT
MAIN PROC FAR 
ASSUME CS:CODE,DS:DATA,SS:STSG,ES:NOTHING

MOV     NUMS[0H],9
MOV     NUMS[1H],8
MOV     NUMS[2H],7
MOV     NUMS[3H],6
MOV     NUMS[4H],5
MOV     NUMS[5H],4
MOV     NUMS[6H],3
MOV     NUMS[7H],2
MOV     NUMS[8H],1


MOV     AX,8H ;HIGH
PUSH    AX
MOV     AX,0H ;LOW
PUSH    AX
LEA		AX,NUMS
PUSH	AX
CALL    QSORT

CALL	PRINTNUMS

MOV		AH,4CH

INT 	21H

MAIN ENDP

QSORT PROC
    PUSH    BP
    MOV     BP,SP
    PUSH	AX
    PUSH	BX
    PUSH	CX
    MOV		BX,[BP+4];ARRAY
    MOV		DI,[BP+6];I=L
    MOV		SI,[BP+8];J=R
    CMP		DI,SI
    JNL		DONE
    MOV		CL,[BX+DI]
QLOOP:
    CMP		DI,SI
    JL		SLOOP1
    CMP		SI,DI
    JL		SLOOP1
    JMP		LOOPEND
    
SLOOP1:
    MOV		AL,[BX+SI]
    CMP		AL,CL
    JLE		LOOP1
    CMP		SI,DI
    JLE		LOOP1
    SUB		SI,1	
    JMP		SLOOP1
    
LOOP1:
	CMP		DI,SI
	JNL		LOOP2
	MOV		AL,[BX+SI]
	MOV		[BX+DI],AL
	ADD		DI,1
LOOP2:
	MOV		AL,[BX+DI]
	CMP		AL,CL
	JNL		LOOP3
	CMP		SI,DI
	JLE		LOOP3
	ADD		DI,1
	JMP		LOOP2
LOOP3:
	CMP		DI,SI
	JNL		QLOOP
	MOV		AL,[BX+DI]
	MOV		[BX+SI],AL
	SUB		SI,1
	JMP		QLOOP
	
LOOPEND:
	MOV		[BX+DI],CL
;CALL ONE
	PUSH	DX
	PUSH	DI
	PUSH	SI
	
	MOV		AX,SI
	SUB		AX,1
	PUSH	AX
	MOV		AX,[BP+6]
	PUSH	AX
	MOV		AX,[BP+4]
	PUSH	AX
	CALL	QSORT
	POP		AX
	POP		AX
	POP		AX
	
	POP		SI
	POP		DI
	POP		DX
;CALL TWO
	PUSH	DX
	PUSH	DI
	PUSH	SI
	
	MOV		AX,[BP+8]
	PUSH	AX
	MOV		AX,DI
	ADD		AX,1
	PUSH	AX
	MOV		AX,[BP+4]
	PUSH	AX
	CALL	QSORT
	POP		AX
	POP		AX
	POP		AX
	
	POP		SI
	POP		DI
	POP		DX
 
DONE:    
	MOV		SP,BP
    POP		BP
    RET		
    
QSORT ENDP


PRINTNUMS	PROC
	PUSH	DX
	PUSH	AX
	PUSH	BX
	MOV		DX,0
	MOV		AX,0
	
	LEA		BX,NUMS
	
	MOV		DX,[BX]
	ADD		DX,30H
	MOV		AH,2
	INT		21H
	
	MOV		DX,[BX+1]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+2]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+3]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+4]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+5]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+6]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+7]
	ADD		DX,30H
	INT		21H
	MOV		DX,[BX+8]
	ADD		DX,30H
	INT		21H
	
	POP		BX
	POP		AX
	POP		DX
	
	RET
PRINTNUMS	ENDP
CODE ENDS

    END MAIN







ND START

